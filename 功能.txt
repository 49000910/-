一、 核心基础逻辑
智能识别扫码枪：利用时间差算法（SCAN_SPEED_THRESHOLD），能精准分辨是“扫码枪高速录入”还是“人工键盘打字”，仅对扫码内容执行自动化逻辑。
本地数据库同步：自动读写 barcode_history.txt，重启软件后已采集的条码记录依然存在，防止跨天、跨批次的重复。
二、 手动扫码模式 (Manual Mode)
这是你平时对着采集框直接扫码时的逻辑：
重复拦截（PB 逻辑）：
视觉： 整个窗口（标题、按钮、Log）瞬间变为珊瑚红。
听觉： 触发 1000Hz 蜂鸣警报音。
动作： 自动执行 Shift + Tab（退回上一个框）并 Ctrl + A（全选条码），确保你下一枪直接覆盖错误条码。
正常录入：
视觉： 窗口变为清新绿，Log 显示大号条码。
存储： 自动存入历史库。
三、 批量录入模式 (Batch Mode)
点击“批量录入窗”后的自动化流程：
子窗口控制：
读取去重： 从剪贴板提取条码，自动执行去重并按照 0-9/A-Z 升序排列。
状态保持： 关闭子窗口后条码列表依然保留，方便分段操作。
静默录入逻辑：
不干扰策略： 自动录入期间，窗口不参加变红/变绿的闪烁逻辑，避免视觉干扰。
透明避让： 录入时窗口自动变为 0.45 半透明，方便你观察采集软件底层的状态。
Log 同步： 即使是自动录入，Log 依然会实时跳动显示当前条码（加粗大号字）。
四、 安全与容错逻辑 (Safety First)
这是为了防止程序“跑飞”或误操作设计的保护伞：
鼠标晃动止付：在自动录入期间，如果你发现异常（如弹窗遮挡或位置点错），只需快速甩动鼠标，录入会立即强行切断。
一键数据回滚：录入中断后，程序会弹出对话框询问是否删除已录入记录。点击“是”，刚才录入成功的条码会从历史库和文件中彻底擦除，仿佛从未发生。
参数可调：
E (录入延迟)： 条码打完后等多久敲回车（默认 0.01s 极速）。
待 (加载等待)： 回车后等多久录下一条（默认 0.85s，适配系统加载）。
五、 UI 与交互细节
全组件联动：背景色变化覆盖所有按钮和文字背景，视觉统一。
Log 视觉焦点：当前操作的条码永远在 Log 第一行，且字体比其他行大一号，方便余光定位。
无边框悬浮：无系统边框，支持鼠标在任意位置拖动，置顶显示。
🚀 下一步你可以做什么？
如果你需要分发给同事使用，或者想让它更像一个“正式软件”，我可以帮你：
添加配置文件保存：让你设置好的 E 和 待 参数在下次打开时自动恢复。
打包成 .exe 文件：不需要安装 Python 环境即可运行。
增加“今日统计”：在界面显示今天分别扫了多少个，批量导入了多少个。
需要我为你编写打包成 EXE 的具体指令，还是继续优化某个功能？
